<!DOCTYPE HTML>
<html>

<head>
  <meta charset="UTF-8">
  <title>keyput.com</title>
  <script type="text/javascript" src="elm.js"></script>
  <link rel="stylesheet" href="style.css">
</head>

<body>
</body>

<script type="text/javascript">
var storedState = localStorage.getItem('keyput-state');
var startingState = storedState ? JSON.parse(storedState) : null;
var keyput = Elm.fullscreen(Elm.Main, { getStorage: startingState });

keyput.ports.focus.subscribe(function(action) {
    setTimeout(function(){
        if (action === 'Enter') {
            $inputs = document.querySelectorAll('.input-actions');
            for (var i = 0; i < $inputs.length; i++) {
                if ($inputs[i] && $inputs[i].offsetParent !== null) {
                    $inputs[i].focus();
                }
            }
        } else if (action == "ItemList Esc" || action == "ItemList Enter") {
            var $input = document.querySelector('.input-main');
            $input.focus();
        }
    }, 20)
});

keyput.ports.setStorage.subscribe(function(state) {
    localStorage.setItem('keyput-state', JSON.stringify(state));
});
</script>

</html>

